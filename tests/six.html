<html>
  <head>
    <title>HotDrink Test</title>
    <script type="text/javascript" src="hotdrink.js"></script>
    <script type="text/javascript">
function calcLeft() {
  return this.right - this.width;
}

function calcRight() {
  return this.left + this.width;
}

function calcWidth() {
  var m= Math.random() * 1000000000;
  for (var i= 0; i < m; ++i);
  return this.right - this.left;
}

function calcTop() {
  return this.height - this.bottom;
}

function calcBottom() {
  return this.top + this.height;
}

function calcHeight() {
  return this.bottom - this.top;
}

function calcWidthAspect() {
  var m= Math.random() * 4000000000;
  for (var i= 0; i < m; ++i);
  return this.height * this.aspect;
}

function calcHeightAspect() {
  return this.width / this.aspect;
}

function calcAspect() {
  return this.width / this.height;
}

var m;
function init() {
  m= hd.makeModel( {left: 0, top: 0, right: undefined, bottom: undefined,
                    width: 200, height: 200, aspect: undefined} );

  var cns= m.constraint( ['left', 'right', 'width'] );
  m.method( cns, 'left', calcLeft );
  m.method( cns, 'right', calcRight );
  m.method( cns, 'width', calcWidth );

  cns= m.constraint( ['top', 'bottom', 'height'] );
  m.method( cns, 'top', calcTop );
  m.method( cns, 'bottom', calcBottom );
  m.method( cns, 'height', calcHeight );

  cns= m.constraint( ['width', 'height', 'aspect'] );
  m.method( cns, 'width', calcWidthAspect );
  m.method( cns, 'height', calcHeightAspect );
  m.method( cns, 'aspect', calcAspect );

  hd.register( m );

  hd.bind();

  hd.forceAsync();
}
    </script>
    <style type="text/css">
      .pending { background: #aaa; }
      .source{ border: 2px solid #339; }
    </style>
  </head>
  <body onload="init()">
    <table>
      <tr>
        <td>Left:</td>
        <td><input type="text" data-bind="number: m.left, css: m.left"/></td>
        <td>Right:</td>
        <td><input type="text" data-bind="number: m.right, css: m.right"/></td>
        <td>Width:</td>
        <td><input type="text" data-bind="number: m.width, css: m.width"/></td>
        <td rowspan="2">Aspect:</td>
        <td rowspan="2"><input type="text" data-bind="number: m.aspect, css: m.aspect"/></td>
      </tr>
      <tr>
        <td>Top:</td>
        <td><input type="text" data-bind="number: m.top, css: m.top"/></td>
        <td>Bottom:</td>
        <td><input type="text" data-bind="number: m.bottom, css: m.bottom"/></td>
        <td>Height:</td>
        <td><input type="text" data-bind="number: m.height, css: m.height"/></td>
      </tr>
    </table>
  </body>
</html>
